
<template name="globalSearchHeaderBar">
  {{#if currentUser}}
    <h1>
      <i class="fa fa-search"></i>
      {{_ 'globalSearch-title'}}
    </h1>
  {{/if}}
</template>

<template name="globalSearchModalTitle">
  {{#if currentUser}}
    <h2>
      <i class="fa fa-keyboard-o"></i>
      {{_ 'globalSearch-title'}}
    </h2>
  {{/if}}
</template>

<template name="resultsPaged">
  {{#if resultsHeading.get}}
    <h1>
      {{resultsHeading.get}}
      <a class="fa fa-link" title="{{_ 'link-to-search'}}" href="{{getSearchHref}}"></a>
    </h1>
  {{/if}}
  {{#each card in results.get}}
    {{> resultCard card}}
  {{/each}}
  <table class="global-search-footer">
    <tr>
      <td class="global-search-previous-page">
        {{#if hasPreviousPage.get}}
          <button class="js-previous-page">{{_ 'previous-page'}}</button>
        {{/if}}
      </td>
      <td class="global-search-next-page" align="right">
        {{#if hasNextPage.get}}
          <button class="js-next-page">{{_ 'next-page'}}</button>
        {{/if}}
      </td>
    </tr>
  </table>
</template>

<template name="globalSearch">
  {{#if currentUser}}
    <div class="wrapper">
      <form class="global-search-page js-search-query-form">
        <input class="global-search-query-input" 
               style="{{#if hasResults.get}}display: inline-block;{{/if}}"
               id="global-search-input"
               type="text"
               name="searchQuery"
               placeholder="{{_ 'search-example'}}"
               value="{{query.get}}"
               autofocus
               dir="auto">
        <a class="js-new-search fa fa-eraser"></a>
      </form>
      {{#if debug.get.show}}
        <h1>Debug</h1>
        {{#if debug.get.showSelector}}
          <h2>Selector
            <button class="js-copy-debug-selector">Copy</button>
          </h2>
          <pre id="debug-selector">{{sessionData.selector}}</pre>
        {{/if}}
        {{#if debug.get.showProjection}}
          <h2>Projection
            <button class="js-copy-debug-projection">Copy</button>
          </h2>
          <pre id="debug-projection">{{sessionData.projection}}</pre>
        {{/if}}
      {{/if}}
      {{#if searching.get}}
        {{> spinner}}
      {{else}}
        {{#if hasResults.get}}
          <div class="global-search-results-list-wrapper">
            {{#if hasQueryErrors.get}}
              <ul>
                {{#each msg in errorMessages}}
                  <li class="global-search-error-messages">{{msg}}</li>
                {{/each}}
              </ul>
            {{/if}}
            {{> resultsPaged this}}
          </div>
        {{else}}
          {{#if serverError.get}}
            <div class="global-search-page">
              <div class="global-search-help">
                <h1>{{_ 'server-error'}}</h1>
                {{#viewer}}
                  {{_ 'server-error-troubleshooting'}}
                {{/viewer}}
              </div>
            </div>
          {{else}}
            <div class="global-search-page">
              <div class="global-search-help">
                <h2>{{_ 'boards'}}</h2>
                <div class="lists-wrapper">
                  {{#each title in myBoardNames.get}}
                    <span class="card-label list-title js-board-title">{{title}}</span>
                  {{/each}}
                </div>
                <h2>{{_ 'lists'}}</h2>
                <div class="lists-wrapper">
                  {{#each title in myLists.get}}
                    <span class="card-label list-title js-list-title">{{title}}</span>
                  {{/each}}
                </div>
                <h2>{{_ 'label-colors'}}</h2>
                <div class="palette-colors">
                  {{#each label in labelColors}}
                    <span class="card-label palette-color js-label-color card-label-{{label.color}}">{{label.name}}</span>
                  {{/each}}
                </div>
                {{#if myLabelNames.get.length}}
                  <h2>{{_ 'label-names'}}</h2>
                  <div class="lists-wrapper">
                    {{#each name in myLabelNames.get}}
                      <span class="card-label list-title js-label-name">{{name}}</span>
                    {{/each}}
                  </div>
                {{/if}}
              </div>
              <div class="global-search-instructions">
                {{#viewer}}
                  {{searchInstructions}}
                {{/viewer}}
              </div>
            </div>
          {{/if}}
        {{/if}}
      {{/if}}
    </div>
  {{/if}}
</template>